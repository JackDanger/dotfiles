
athena-query() {
  local sql=$1
  local workgroup=${2:-primary}
  local execution_id=$(aws athena start-query-execution --query-string $sql --work-group $workgroup | jq -r .QueryExecutionId)
  
  while [[ "RUNNING" == "$(athena-query-status $query_id)" ]]; do
   echo -n .
   sleep 1
  done
  aws athena get-query-results --query-execution-id $query_id
}

athena-query-status() {
  local $execution_id=$1
  aws athena get-query-execution --query-execution-id $query_id | jq -r .QueryExecution.Status.State
}
